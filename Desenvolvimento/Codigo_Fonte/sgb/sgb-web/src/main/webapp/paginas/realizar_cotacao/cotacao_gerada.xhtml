<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html >
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:f="http://java.sun.com/jsf/core">

    <ui:composition template="/template/template.xhtml">

        <ui:define name="content">

            <h:form id="formCotacaoGerada" style="font-size: 14px;">
                
                <p:messages/>

                <p:panel header="#{msg['label.cotacao.cotarLivro']}">
                    
                    
                    <p:dataTable id="tabelaCotacoes" paginator="true" rows="10" value="#{realizarCotacaoController.form.cotacoesDataModel}" 
                                 var="cotacao" style="text-align: center;" editable="true" editMode="cell" selection="#{realizarCotacaoController.form.cotacoesSelecionadas}">
                    
                        <p:ajax event="cellEdit" update=":formCotacaoGerada:tabelaCotacoes" />
                        
                        <p:column selectionMode="multiple" style="width:18px" />

                        <p:column>

                               <p:graphicImage url="http://1.bp.blogspot.com/-n-fsjwiesiw/Tr7UmKfH6JI/AAAAAAAAAXQ/PUbQNNaU0bY/s1600/fundacao.jpg" width="50" height="73" />

                        </p:column>

                        <p:column headerText="Título">

                                <h:outputLabel value="#{cotacao.livro.titulo}"/>

                        </p:column>
                            
                        <p:column headerText="Autor(es)">
                        
                                <h:outputLabel value="#{cotacao.livro.autoresAsString}"/>

                        </p:column>
                        
                        <p:column headerText="N° da Edição">        
                                
                                <h:outputLabel value="#{cotacao.livro.edicao}"/>
                        
                        </p:column>    
                        
                        <p:column headerText="Ano">

                                <h:outputLabel value="#{cotacao.livro.ano}"/>

                        </p:column>
                        
                        <p:column headerText="ISBN-13">
                                
                                <h:outputLabel value="#{cotacao.livro.isbn13} "/>

                        </p:column>

                        <p:column>

                            <p:commandButton value="Livrarias" id="btnLivrarias"/>
                            
                            <p:overlayPanel for="btnLivrarias">
                            
                                <p:dataTable value="#{cotacao.livraria}" var="livraria">

                                    <p:column headerText="#{msg['label.cotacao.loja']}">



                                    </p:column>

                                    <p:column headerText="#{msg['label.cotacao.valor']}">

                                    </p:column>

                                </p:dataTable>
                           
                            </p:overlayPanel>

                        </p:column>
                        
                        <p:column headerText="Quantidade">
                            
                            <p:cellEditor>  
                                
                                <f:facet name="output"><h:outputText value="#{cotacao.quantidade}" /></f:facet>  
                            
                                <f:facet name="input"><p:inputText id="modelInput" value="#{cotacao.quantidade}"/></f:facet>  
                                
                            </p:cellEditor>    
                                
                        </p:column>
                        
                        <p:column headerText="Preço Médio em R$">
                            
                            <p:cellEditor>  
                                
                                <f:facet name="output">
                                    
                                    <h:outputText value="#{cotacao.valor}">
                                        
                                        <f:convertNumber maxFractionDigits="2"/> 
                                        
                                    </h:outputText>
                                
                                </f:facet>  
                            
                                <f:facet name="input"><p:inputText id="precoInput" value="#{cotacao.valor}"/></f:facet>  
                                
                            </p:cellEditor>    
                                
                        </p:column>
                        
                        <p:column headerText="Preço Total em R$">
                                                           
                            <h:outputText value="#{cotacao.valor * cotacao.quantidade}">

                                <f:convertNumber maxFractionDigits="2"/> 

                            </h:outputText>                                  
                                
                        </p:column>
                    
                    </p:dataTable>
                    
                    <p:spacer height="25" width="5"/>
                    
                    <h:panelGrid width="100%" style="text-align: right;">
                        
                        <h:panelGrid width="100%" style="text-align: right;" columns="2">

                            <p:commandButton value="#{msg['acao.salvar']}" style="width: 120px" />

                            <p:commandButton value="#{msg['acao.voltar']}" ajax="false" action="#{realizarCotacaoController.openInitialPage()}" style="width: 120px" />

                        </h:panelGrid>
                   
                    </h:panelGrid>
                    
                </p:panel>

            </h:form>

        </ui:define>

    </ui:composition>

</html>